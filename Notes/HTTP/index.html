<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Hypertext Transfer Protocol HTTP is the Web&rsquo;s application layer protocol, above the transport or optional encryption layer. A Web page contains many objects and is addressable using a Uniform Resource Locator (URL): HTTP uses TCP as its underlying transport protocol."><title>HTTP</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://www.brendanang.dev//icon.png><link href=https://www.brendanang.dev/styles.c6adaa3b473914a38283f492dfdbcb76.min.css rel=stylesheet><link href=https://www.brendanang.dev/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://www.brendanang.dev/js/darkmode.f4d43c22d05773345705b5a308888af6.min.js></script>
<script src=https://www.brendanang.dev/js/util.fa8e74b4065b97e6980a72cc472e436f.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://www.brendanang.dev/js/popover.9b72b70bd35617d0635e9d15463662b2.min.js></script>
<script src=https://www.brendanang.dev/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://www.brendanang.dev/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://www.brendanang.dev/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,PRODUCTION=!0,BASE_URL="https://www.brendanang.dev/",fetchData=Promise.all([fetch("https://www.brendanang.dev/indices/linkIndex.f42c7fcb66d9399c0737437c54fd65de.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://www.brendanang.dev/indices/contentIndex.9afbb7278a8288f5bf0368f2332484fe.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://www.brendanang.dev",!0,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!0;drawGraph("https://www.brendanang.dev",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}var i=document.getElementsByClassName("mermaid");i.length>0&&import("https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs").then(e=>{e.default.init()})},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'â€™':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/www.brendanang.dev\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://www.brendanang.dev/js/full-text-search.51f0b1753e9b30839d053f8a98cc20d1.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://www.brendanang.dev/>Brendan Ang</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>HTTP</h1><p class=meta>Last updated
Dec 3, 2022
<a href=https://github.com/bbawj/site/Notes/HTTP.md rel=noopener>Edit Source</a></p><ul class=tags></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#a-brief-history-rundown>A brief history rundown</a></li><li><a href=#http-message-format>HTTP message format</a><ol><li><a href=#request>Request</a></li><li><a href=#response>Response</a></li></ol></li><li><a href=#user-server-state>User-Server State</a><ol><li><a href=#cookies>Cookies</a></li></ol></li><li><a href=#web-caching>Web Caching</a></li><li><a href=#optimisations-in-http-11>Optimisations in HTTP 1.1</a><ol><li><a href=#http-keepalive>HTTP Keepalive</a></li><li><a href=#http-pipelining>HTTP Pipelining</a></li><li><a href=#parallel-tcp-connections>Parallel TCP Connections</a></li><li><a href=#domain-sharding>Domain Sharding</a></li></ol></li><li><a href=#enhancements-in-http-20>Enhancements in HTTP 2.0</a><ol><li><a href=#binary-framing-layer>Binary Framing Layer</a></li><li><a href=#request-and-response-multiplexing>Request and Response Multiplexing</a></li><li><a href=#request-prioritisation>Request Prioritisation</a></li><li><a href=#server-push>Server Push</a></li><li><a href=#header-compression>Header Compression</a></li></ol></li></ol></nav></details></aside><a href=#hypertext-transfer-protocol><h1 id=hypertext-transfer-protocol><span class=hanchor arialabel=Anchor># </span>Hypertext Transfer Protocol</h1></a><p>HTTP is the Web&rsquo;s application layer protocol, above the transport or optional encryption layer.
A Web page contains many objects and is addressable using a Uniform Resource Locator (URL):
<img src=https://i.imgur.com/TxqKYuV.png width=auto alt>
<strong>HTTP uses TCP as its underlying transport protocol.</strong></p><a href=#a-brief-history-rundown><h2 id=a-brief-history-rundown><span class=hanchor arialabel=Anchor># </span>A brief history rundown</h2></a><ol><li>HTTP 0.9 began in 1991 with the goal of transferring HTML between client and server.</li><li>HTTP 1.0 evolved to add more capabilities such as header fields and supporting more than HTML file types, becoming a misnomer for hypermedia transport.
A typical plaintext HTTP request
<img src=https://i.imgur.com/NMRHtwo.png width=auto alt=400></li><li>HTTP 1.1 introduced critical performance optimisations such as keepalive connections, chunked encoding transfers and additional caching mechanisms.</li><li>HTTP 2.0 aimed to improve transport performance for lower latency and higher throughput.</li></ol><a href=#http-message-format><h2 id=http-message-format><span class=hanchor arialabel=Anchor># </span>HTTP message format</h2></a><a href=#request><h3 id=request><span class=hanchor arialabel=Anchor># </span>Request</h3></a><p>GET, POST, PUT, UPDATE, DELETE, HEAD methods are available
<img src=https://i.imgur.com/yMFZlsC.png width=auto alt></p><a href=#response><h3 id=response><span class=hanchor arialabel=Anchor># </span>Response</h3></a><p><img src=https://i.imgur.com/kpb7ngf.png width=auto alt></p><a href=#user-server-state><h2 id=user-server-state><span class=hanchor arialabel=Anchor># </span>User-Server State</h2></a><p>HTTP is a <em>stateless</em> protocol, and does not maintain information about the clients. This simplifies server design and allow for high-performance web servers.</p><a href=#cookies><h3 id=cookies><span class=hanchor arialabel=Anchor># </span>Cookies</h3></a><p>It is often desirable for a Web site to identify users, either to restrict user access or serve specific content.
Cookie technology consists of 4 components:</p><ol><li>Cookie header line in the HTTP response message</li><li>Cookie header line in the HTTP request message</li><li>Cookie file kept on the userâ€™s end system and managed by the userâ€™s browser</li><li>Back-end database at the Web site
<img src=https://i.imgur.com/13VLbBW.png width=auto alt></li></ol><a href=#web-caching><h2 id=web-caching><span class=hanchor arialabel=Anchor># </span>Web Caching</h2></a><p>A proxy server acts as a Web cache with its own disk storage and keeps recently requested objects. The proxy server sits on the LAN and reduces response time for a request.
<img src=https://i.imgur.com/nZHDsPZ.png width=auto alt=500></p><a href=#optimisations-in-http-11><h2 id=optimisations-in-http-11><span class=hanchor arialabel=Anchor># </span>Optimisations in HTTP 1.1</h2></a><p><img src=https://i.imgur.com/WlgrLkY.png width=auto alt=500x500></p><a href=#http-keepalive><h3 id=http-keepalive><span class=hanchor arialabel=Anchor># </span>HTTP Keepalive</h3></a><p>Reuse existing TCP connections paired with
<a href=/Notes/Transmission-Control-Protocol/ rel=noopener class=internal-link data-src=/Notes/Transmission-Control-Protocol/>TCP Keep-Alive</a> to save 1 roundtrip of network latency
<img src=https://i.imgur.com/TnE3vW7.png width=auto alt=500x550></p><a href=#http-pipelining><h3 id=http-pipelining><span class=hanchor arialabel=Anchor># </span>HTTP Pipelining</h3></a><p>Persistent HTTP implies a strict FIFO order of client requests: <em>dispatch request, wait for full response, dispatch next request</em>. Pipelining moves the queue to the server side, allows the client to send all requests at once, and reduces server idle time by processing requests immediately without delay.
<img src=https://i.imgur.com/XX16E1l.png width=auto alt=500x550></p><a href=#why-not-do-server-processing-in-parallel><h4 id=why-not-do-server-processing-in-parallel><span class=hanchor arialabel=Anchor># </span>Why not do server processing in parallel?</h4></a><p><img src=https://i.imgur.com/pElNewg.png width=auto alt=500x500>
The HTTP 1.x protocol enforces a requirement similar to that encountered in
<a href=/Notes/Transmission-Control-Protocol/ rel=noopener class=internal-link data-src=/Notes/Transmission-Control-Protocol/>TCP Head-of-Line Blocking due to its requirement for strict in-order packet delivery</a>, where there must be strict serialization of returned responses. Hence, although the CSS response finishes first, the server must wait for the full HTML response before it can deliver the CSS asset.</p><a href=#parallel-tcp-connections><h3 id=parallel-tcp-connections><span class=hanchor arialabel=Anchor># </span>Parallel TCP Connections</h3></a><p>Rather than opening one TCP connection, and sending each request one after another on the client, we can open multiple TCP connections in parallel. In practice, most browsers use a value of 6 connections per host.</p><p>These connections are considered independent, and hence do not face the same head-of-line blocking issues in parallel server processing.</p><a href=#domain-sharding><h3 id=domain-sharding><span class=hanchor arialabel=Anchor># </span>Domain Sharding</h3></a><p>Although browsers can maintain a connection pool of up to 6 TCP streams per host, this might not be enough considering how an average page needs 90+ individual resources. If delivered all by the same host, there will be queueing delays:
<img src=https://i.imgur.com/b7BFL36.png width=auto alt>
Sharding can artificially split up a single host <em>e.g.
<a href=https://www.example.com rel=noopener>www.example.com</a> into {shard1,shard2}.example.com</em>, helping to achieve higher levels of parallelism at a cost of additional network resources.</p><a href=#enhancements-in-http-20><h2 id=enhancements-in-http-20><span class=hanchor arialabel=Anchor># </span>Enhancements in HTTP 2.0</h2></a><p>HTTP 2.0 extends the standards from previous versions, and is designed to allow all applications using previous versions to carry on without modification.</p><a href=#binary-framing-layer><h3 id=binary-framing-layer><span class=hanchor arialabel=Anchor># </span>Binary Framing Layer</h3></a><p>At the core of the performance enhancements, is this layer which dictates how the HTTP messages are encapsulated and transferred. Rather than delimiting parts of the protocol in newlines like in HTTP 1.x, all communication is split into smaller frames and encoded in binary:
<img src=https://i.imgur.com/X63wgSm.png width=auto alt=500></p><blockquote class="[! frames, messages and streams]-callout"><p>[! Frames, Messages and Streams]
Frames: The smallest unit of communication in HTTP 2.0, each containing a frame header, which at minimum identifies the stream to which the frame belongs. It contains data such as HTTP headers, payload etc.</p><p>Messages: A complete sequence of frames that map to a logical message. It can be a request or response.</p><p>Stream: A bidirectional flow of bytes within an established connection</p><p><em>Each TCP connection can carry any number of streams which communicates in messages consisting of one or multiple frames.</em></p></blockquote><a href=#request-and-response-multiplexing><h3 id=request-and-response-multiplexing><span class=hanchor arialabel=Anchor># </span>Request and Response Multiplexing</h3></a><p>In
<a href=/Notes/HTTP/ rel=noopener class=internal-link data-src=/Notes/HTTP/>Why not do server processing in parallel?</a>, we find that only one response can be delivered at a time per connection. HTTP 2.0 removes these limitations.
<img src=https://i.imgur.com/4yenXqI.png width=auto alt>
With this, workaround optimisations in HTTP 1.x such as domain sharding is no longer necessary.</p><a href=#request-prioritisation><h3 id=request-prioritisation><span class=hanchor arialabel=Anchor># </span>Request Prioritisation</h3></a><p>The exact order in which the frames are interleaved and delivered can be optimised further by assigning a 31 bit priority value (0 represents highest, $2^{31}-1$ being the lowest). HTTP 2.0 merely provides the mechanism for which priority data can be exchanged, and <em>does not implement any specific prioritisation algorithm</em>. It is up to the server to implement this.</p><a href=#server-push><h3 id=server-push><span class=hanchor arialabel=Anchor># </span>Server Push</h3></a><p>A document contains dozens of resources which the client will discover. To eliminate extra latency, let the server figure out what resources the client will require and push it ahead of time. Essentially, the server can send multiple replies for a single request, without the client having to explicitly request each resource.
<img src=https://i.imgur.com/x37U1Im.png width=auto alt></p><a href=#header-compression><h3 id=header-compression><span class=hanchor arialabel=Anchor># </span>Header Compression</h3></a><p>Each HTTP transfer carries a set of headers that describe the transferred resource and its properties. In HTTP 1.x, this metadata is always sent as plain text and adds anywhere from 500â€“800 bytes of overhead per request, and kilobytes more if HTTP cookies are required.</p><a href=#header-table><h4 id=header-table><span class=hanchor arialabel=Anchor># </span>Header table</h4></a><p>A header table is used on both the client and server to track and store previously sent key value pairs. They are persisted for the entire connection and incrementally updated both by the client and server. Each new pair is either appended or replaces a previous value in the table.
This allows a new set of headers to be coded as a simple difference from the previous set:
<img src=https://i.imgur.com/E09FU77.png width=auto alt=400></p></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/Notes/Application-Layer/ data-ctx=HTTP data-src=/Notes/Application-Layer class=internal-link>Application Layer</a></li><li><a href=/Notes/HTTP/ data-ctx="Why not do server processing in parallel?" data-src=/Notes/HTTP class=internal-link>HTTP</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://www.brendanang.dev/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p>Made by Brendan Ang using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, Â© 2023</p><ul><li><a href=https://www.brendanang.dev/>Home</a></li><li><a href=https://github.com/bbawj>Github</a></li></ul></footer></div></div></body></html>