<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=description content="Security Protection Stages Identification & Auth: comparing input credentials with stored ones Users & Access Control Principle of least privilege"><title>OS Security
</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://www.brendanang.dev//icon.png><link href=https://www.brendanang.dev/styles.c6adaa3b473914a38283f492dfdbcb76.min.css rel=stylesheet><link href=https://www.brendanang.dev/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://www.brendanang.dev/js/darkmode.f4d43c22d05773345705b5a308888af6.min.js></script><script src=https://www.brendanang.dev/js/util.fa8e74b4065b97e6980a72cc472e436f.min.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script><script src=https://unpkg.com/@floating-ui/core@0.7.3></script><script src=https://unpkg.com/@floating-ui/dom@0.5.4></script><script src=https://www.brendanang.dev/js/popover.9b72b70bd35617d0635e9d15463662b2.min.js></script><script src=https://www.brendanang.dev/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script><script src=https://www.brendanang.dev/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script><script src=https://www.brendanang.dev/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script><script>const SEARCH_ENABLED=!1,PRODUCTION=!0,BASE_URL="https://www.brendanang.dev/",fetchData=Promise.all([fetch("https://www.brendanang.dev/indices/linkIndex.84a6714a5001f23f619a6012b456b34d.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://www.brendanang.dev/indices/contentIndex.61de53cbb96862628149d53bfdffe9d4.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://www.brendanang.dev",!0,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!0;drawGraph("https://www.brendanang.dev",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}var i=document.getElementsByClassName("mermaid");i.length>0&&import("https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs").then(e=>{e.default.init()})},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{"’":"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/www.brendanang.dev\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script><script defer src=https://www.brendanang.dev/js/full-text-search.51f0b1753e9b30839d053f8a98cc20d1.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://www.brendanang.dev/>Brendan Ang</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg>
</label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>OS Security</h1><p class=meta>Last updated
Sep 21, 2023
<a href=https://github.com/bbawj/site/Notes/OS%20Security.md rel=noopener>Edit Source</a></p><ul class=tags></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#users--access-control>Users & Access Control</a><ol><li><a href=#security-policy>Security Policy</a></li><li><a href=#groups>Groups</a></li></ol></li><li><a href=#process--controlled-invocation>Process Controlled Invocation</a><ol><li><a href=#rootkit>RootKit</a></li></ol></li><li><a href=#logging>Logging</a></li></ol><ol><li><a href=#virtualizationnotesvirtualizationmd><a href=Notes/Virtualization.md>Virtualization</a></a></li><li><a href=#containers>Containers</a></li><li><a href=#reference-monitors>Reference Monitors</a><ol><li><a href=#requirements>Requirements</a></li></ol></li></ol><ol><li><a href=#software>Software:</a></li><li><a href=#hardware>Hardware</a><ol><li><a href=#trusted-platform-module-tpm>Trusted Platform Module (TPM)</a></li></ol></li></ol></nav></details></aside><p><img src=https://www.brendanang.dev//Pics/Pasted%20image%2020230921121212.png width=auto alt></p><a href=#security-protection-stages><h1 id=security-protection-stages><span class=hanchor arialabel=Anchor># </span>Security Protection Stages</h1></a><p><img src=https://www.brendanang.dev//Pics/Pasted%20image%2020230925214938.png width=auto alt></p><ul><li>Identification & Auth: comparing input credentials with stored ones</li></ul><a href=#users--access-control><h2 id=users--access-control><span class=hanchor arialabel=Anchor># </span>Users & Access Control</h2></a><p>Principle of least privilege</p><ul><li>users should only have access to resources needed to perform the desired tasks
Privilege separation</li><li>split a system into different components each with the least privilege for its task</li><li>prevents any attacker from taking over the entire system</li></ul><p>A system can have many accounts. 16 bit UIDs are used to identify accounts, e.g. root(0), bin(1). An attacker managing to get root user status effectively takes over the entire system.</p><a href=#security-policy><h3 id=security-policy><span class=hanchor arialabel=Anchor># </span>Security Policy</h3></a><p><a href=/Notes/File-Systems/ rel=noopener class=internal-link data-src=/Notes/File-Systems/>File permissions</a> are used to control access. They are split into subjects (the user, program, process etc.) , object (file, memory) and operation (read/write/execute).
<img src=https://www.brendanang.dev//Pics/Pasted%20image%2020230921135811.png width=auto alt></p><a href=#groups><h3 id=groups><span class=hanchor arialabel=Anchor># </span>Groups</h3></a><p><img src=https://www.brendanang.dev//Pics/Pasted%20image%2020230921135210.png width=auto alt></p><a href=#process--controlled-invocation><h2 id=process--controlled-invocation><span class=hanchor arialabel=Anchor># </span>Process Controlled Invocation</h2></a><p>Processes are assigned 2 types of user and group IDs.
<img src=https://www.brendanang.dev//Pics/Pasted%20image%2020230921140026.png width=auto alt>
Root user privilege is required to execute certain OS functions, e.g. password changing, which requires R/W access to <code>/etc/shadow</code>. The OS overcomes this by giving additional permissions via a SUID:
<img src=https://www.brendanang.dev//Pics/Pasted%20image%2020230921140143.png width=auto alt></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>// Example Setting SUID for a file such that it executes with the owner permissions of the file
</span></span><span class=line><span class=cl>chmod o+s &lt;FILE&gt;
</span></span><span class=line><span class=cl>// Example Setting SUID for a file such that it executes with the group permissions of the file
</span></span><span class=line><span class=cl>chmod g+s &lt;FILE&gt;
</span></span></code></pre></td></tr></table></div></div><p>By tricking the SUID program owned by root to do unintended things, an attacker can act as root. Hence, all user input must be processed with extreme care, programs should have SUID status only if it is really necessary.</p><a href=#rootkit><h3 id=rootkit><span class=hanchor arialabel=Anchor># </span>RootKit</h3></a><p>Malware that obtains root privileges. It originally referred to a set of maliciously modified set of administrative tools which granted root access. Once granted, uses can be as follows:</p><a href=#hijacking-sys-call-tables><h4 id=hijacking-sys-call-tables><span class=hanchor arialabel=Anchor># </span>Hijacking sys-call tables</h4></a><p><img src=https://www.brendanang.dev//Pics/Pasted%20image%2020230921141520.png width=auto alt></p><p><img src=https://www.brendanang.dev//Pics/Pasted%20image%2020230921141434.png width=auto alt></p><h4 id=hijacking-interrupt-stack-table-istnotesinterruptsmdinterrupt20stack20table20ist20and20task20state20segment20tss>Hijacking
<a href=/Notes/Interrupts/ rel=noopener class=internal-link data-src=/Notes/Interrupts/>Interrupt Stack Table (IST)</a></h4><p><img src=https://www.brendanang.dev//Pics/Pasted%20image%2020230921142335.png width=auto alt></p><a href=#logging><h2 id=logging><span class=hanchor arialabel=Anchor># </span>Logging</h2></a><p><img src=https://www.brendanang.dev//Pics/Pasted%20image%2020230925215919.png width=auto alt></p><a href=#confinement><h1 id=confinement><span class=hanchor arialabel=Anchor># </span>Confinement</h1></a><p>The OS isolates applications in the system. If one is malicious, it prevents the rest of the system from being harmed.</p><h2 id=virtualizationnotesvirtualizationmd><a href=/Notes/Virtualization/ rel=noopener class=internal-link data-src=/Notes/Virtualization/>Virtualization</a></h2><p><img src=https://www.brendanang.dev//Pics/Pasted%20image%2020230922000656.png width=auto alt>
However, hypervisors have higher privileges than the OS kernel, and offer a larger attack surface with larger code bases. If compromised, an attacker can take over the entire system more easily.</p><a href=#containers><h2 id=containers><span class=hanchor arialabel=Anchor># </span>Containers</h2></a><p>Package code and all dependencies into 1 unit called a container. A container engine is used to manage the different containers, which run isolated from each other.
<img src=https://www.brendanang.dev//Pics/Pasted%20image%2020230922001007.png width=auto alt></p><a href=#reference-monitors><h2 id=reference-monitors><span class=hanchor arialabel=Anchor># </span>Reference Monitors</h2></a><p>A mechanism to monitor and mediate/deny requests from protected targets at runtime when a security policy is violated.
<img src=https://www.brendanang.dev//Pics/Pasted%20image%2020230922002352.png width=auto alt></p><a href=#requirements><h3 id=requirements><span class=hanchor arialabel=Anchor># </span>Requirements</h3></a><p>Functional:</p><ul><li>Reference validation mechanism must always be invoked</li><li>RM able to observe all requests and deny malicious request
Security:</li><li>Mechanism must be tamper-proof
Assurance:</li><li>Mechanism must be small enough to be analysed and tested</li></ul><p>Hardware-based RMs are introduced to monitor the OS</p><a href=#integrity-verification><h1 id=integrity-verification><span class=hanchor arialabel=Anchor># </span>Integrity Verification</h1></a><p>A chain of trust is created by establishing verified systems from bottom to top.</p><a href=#software><h2 id=software><span class=hanchor arialabel=Anchor># </span>Software:</h2></a><p><img src=https://www.brendanang.dev//Pics/Pasted%20image%2020230922002830.png width=auto alt></p><a href=#hardware><h2 id=hardware><span class=hanchor arialabel=Anchor># </span>Hardware</h2></a><p>After the chip is fabricated, it is hard for the attacker to modify it. The integrity of hardware can be guaranteed. It is also very hard for the attacker to peek into the chip and steal the secret (e.g., encryption key). The confidentiality of hardware can also be guaranteed. Hardware is a perfect component as the start of the chain of trust.</p><a href=#trusted-platform-module-tpm><h3 id=trusted-platform-module-tpm><span class=hanchor arialabel=Anchor># </span>Trusted Platform Module (TPM)</h3></a><p><img src=https://www.brendanang.dev//Pics/Pasted%20image%2020230922003158.png width=auto alt></p><a href=#platform-integrity><h4 id=platform-integrity><span class=hanchor arialabel=Anchor># </span>Platform Integrity</h4></a><p>Helps build a chain of trust by establishing a secure boot process from the TPM until the OS has fully booted and applications are running.</p><a href=#full-disk-encryption><h4 id=full-disk-encryption><span class=hanchor arialabel=Anchor># </span>Full disk encryption</h4></a><ul><li>Encrypt data with hardware key, which is difficult to steal as it never leaves the chip.</li><li>E.g. Windows Bitlocker encrypts disk with FVEK key. This key is further encrypted with the Storage Root Key in the TPM.</li></ul><a href=#remote-attestation><h4 id=remote-attestation><span class=hanchor arialabel=Anchor># </span>Remote Attestation</h4></a><p>Provide unforgeable evidence about the security of its software to a client for systems to prove that the platform is trustworthy.
<img src=https://www.brendanang.dev//Pics/Pasted%20image%2020230922004109.png width=auto alt>
Integrity measurement architecture:</p><ul><li>Must be able to provide reliable and trustworthy security report.</li><li>TPM provides a platform integrity measurement service which cannot be compromised by the OS or applications.</li><li>Measure the hash value of the code of each loaded software and store them in the Platform Configuration Register
Remote attestation protocol:</li><li>Report must be transmitted to the client without being modified</li><li>TPM is equipped with keys to encrypt and sign messages</li><li>Key is verified with a trusted third party Privacy Certification Authority</li></ul><a href=#trusted-execution-environment-tee><h4 id=trusted-execution-environment-tee><span class=hanchor arialabel=Anchor># </span>Trusted Execution Environment (TEE)</h4></a><p>The TPM can guarantee that privileged software (like the OS), is not malicious at load time, but not the security at runtime. The TEE ensures that the OS should support the execution of apps but should not be able to compromise them by reading data, changing their code.
<img src=https://www.brendanang.dev//Pics/Pasted%20image%2020230922004554.png width=auto alt>
<img src=https://www.brendanang.dev//Pics/Pasted%20image%2020230922005621.png width=auto alt>
With SEV, the TCB can be reduced to just the hardware. The hypervisor does not need to be trusted.
<img src=https://www.brendanang.dev//Pics/Pasted%20image%2020230922005643.png width=auto alt>
<img src=https://www.brendanang.dev//Pics/Pasted%20image%2020230922005743.png width=auto alt>
Use cases:
To provide increased security against malicious actors gaining access to a device’s content, the PIN and fingerprint functionalities used to unlock the Android device must be secured. Privileged and secure access to peripherals (like the fingerprint sensor) is provided by the TEE.</p></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li>No backlinks found</li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://www.brendanang.dev/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p>Made by Brendan Ang using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2025</p><ul><li><a href=https://www.brendanang.dev/>Home</a></li><li><a href=https://github.com/bbawj>Github</a></li></ul></footer></div></div></body></html>